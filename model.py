# -*- coding: utf-8 -*-
"""PRML_Course_Project.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1gcRTAiMow453u2BY6Bq3PYZ8SBuqHv8b

"""

#importing necessary modules
import numpy as np 
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import warnings
warnings.filterwarnings('ignore')


df = pd.read_csv('heart.csv')

from sklearn.preprocessing import LabelEncoder

for col in df.columns:
    if col=='ST_Slope':
        df[col] = df[col].apply(lambda x: 0 if x=='Flat' else (1 if x=='Up' else -1))
    elif df.dtypes[col]=='object':
        df[col] = LabelEncoder().fit_transform(df[col])

df.head()

"""## Standardisation of continuous attributes using StandardScaler()"""

from sklearn.preprocessing import StandardScaler

continuous_cols = ['Age','RestingBP','Cholesterol','MaxHR','Oldpeak']
for col in continuous_cols:
    df[col] = StandardScaler().fit_transform(df[[col]])



X = df.drop('HeartDisease',axis=1)
y = df['HeartDisease']


from sklearn.neural_network import MLPClassifier


pickle.dump(regressor, open('model.pkl','wb'))